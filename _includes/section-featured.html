{% assign featured_posts = site.posts | where: "featured", true %}

{% if featured_posts.size > 0 and site.data.settings.featured.enable == true %}
<!-- begin featured section -->

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide/dist/css/splide.min.css">
<script src="https://cdn.jsdelivr.net/npm/@splidejs/splide/dist/js/splide.min.js"></script>

<style>
  /* CSS Styles */
  .splide__slide__container img {
    width: 100%;
    height: auto;
  }
  .splide__arrow--prev, .splide__arrow--next {
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 50%;
    padding: 0.5rem;
  }
</style>

<section class="section blog animate">
  <div class="container">

    <div class="section__info section__info__center">
      <div class="section__head">
        {% if site.data.settings.featured.featured_intro %}
        <span class="section__intro">{{ site.data.settings.featured.featured_intro }}</span>
        {% endif %}
        {% if site.data.settings.featured.featured_title %}
        <h2 class="section__title">{{ site.data.settings.featured.featured_title }}</h2>
        {% endif %}
        <div class="splide__arrows slider-controls">
          <button class="splide__arrow--prev prev">
            <i class="fa-solid fa-chevron-left"></i>
          </button>
          <button class="splide__arrow--next next">
            <i class="fa-solid fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>

    <div class="splide" data-splide='{"type":"loop","height":"9rem","perPage":2,"breakpoints":{"640":{"height":"6rem"}}}'>
      <div class="splide__track">
        <ul class="splide__list">
          {% assign sorted_featured_posts = featured_posts | sort: 'date' | reverse %}
          {% for post in sorted_featured_posts limit:3 %}
          <li class="splide__slide">
            <div class="splide__slide__container">
              {% include article.html %}
            </div>
          </li>
          {% endfor %}
        </ul>
      </div>
    </div>

  </div>
</section>
<!-- end featured section -->
{% endif %}

<script>
  document.addEventListener( 'DOMContentLoaded', function () {
    new Splide( '.splide', {
      type       : 'loop',
      height     : '9rem',
      perPage    : 2,
      breakpoints: {
        640: {
          height: '6rem',
        },
      },
    } ).mount();
  } );
</script>
