{% assign featured_posts = site.posts | where: "featured", true %}

{% if featured_posts.size > 0 and site.data.settings.featured.enable == true %}
<!-- begin featured section -->
<style>
  /* CSS Styles */
  .row {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
  }

  .slider-container {
    width: 100%;
    display: flex;
    align-items: center;
    margin-bottom: 20px;
  }

  .slider-container label {
    margin-right: 10px;
    font-weight: bold;
  }

  .slider-container input[type="range"] {
    -webkit-appearance: none;
    width: 100%;
    height: 8px;
    background: #ddd;
    outline: none;
    opacity: 0.8;
    transition: opacity 0.2s;
    border-radius: 5px;
  }

  .slider-container input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 25px;
    height: 25px;
    background: #4CAF50;
    cursor: pointer;
    border-radius: 50%;
  }

  .slider-container input[type="range"]::-moz-range-thumb {
    width: 25px;
    height: 25px;
    background: #4CAF50;
    cursor: pointer;
    border-radius: 50%;
  }

  .article {
    flex: 1 1 30%; /* Adjust this value to change the size of the articles */
    margin: 10px;
  }

  .load-more-container {
    text-align: center;
    margin-top: 20px;
  }

  .load-more-button {
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 5px;
    transition: background-color 0.3s;
  }

  .load-more-button:hover {
    background-color: #45a049;
  }
</style>

<section class="section blog animate">
  <div class="container">

    <div class="section__info section__info__center">
      <div class="section__head">
        {% if site.data.settings.featured.featured_intro %}
        <span class="section__intro">{{ site.data.settings.featured.featured_intro }}</span>
        {% endif %}
        {% if site.data.settings.featured.featured_title %}
        <h2 class="section__title">{{ site.data.settings.featured.featured_title }}</h2>
        {% endif %}
      </div>
    </div>

    <div class="slider-container">
      <label for="slider">Adjust size:</label>
      <input type="range" id="slider" name="slider" min="10" max="100" value="30" oninput="adjustSize(this.value)">
    </div>

    <div class="row" id="featured-posts">
      {% assign sorted_featured_posts = featured_posts | sort: 'date' | reverse %}
      {% for post in sorted_featured_posts limit:6 %}
        <div class="article">
          {% include article.html %}
        </div>
      {% endfor %}
    </div>

    <div class="load-more-container">
      <button class="load-more-button" onclick="loadMorePosts()">Load More</button>
    </div>

  </div>
</section>
<!-- end featured section -->
{% endif %}

<script>
  const posts = {{ sorted_featured_posts | jsonify }};
  let loadedPosts = 6;

  function adjustSize(value) {
    document.querySelectorAll('.article').forEach(article => {
      article.style.flex = `1 1 ${value}%`;
    });
  }

  function loadMorePosts() {
    const container = document.getElementById('featured-posts');
    let newPosts = '';
    for (let i = loadedPosts; i < loadedPosts + 3 && i < posts.length; i++) {
      newPosts += `
        <div class="article">
          <div class="article article__grid animate col col-4 col-d-6 col-t-12">
            <div class="article__inner">
          
              <div class="article__head">
                ${posts[i].image ? `
                <a href="${posts[i].href}" class="article__image">
                  ${posts[i].image && posts[i].video_embed ? `
                  <div class="video-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                      <polygon points="40,30 70,50 40,70"></polygon>
                    </svg>
                  </div>` : ''}
                  <img class="lazy" data-src="{{site.baseurl}}${posts[i].image}" alt="${posts[i].title}">
                </a>` : ''}
              </div>
          
              <div class="article__content">
          
                <div class="article__meta">
                  ${posts[i].tags.length >= 1 ? `
                  <div class="article__tags">
                  ${posts[i].tags.map(tag => `
                    <a href="{{ site.baseurl }}/tags/?tag=${tag | cgi_escape}" class="tag-button">${tag}</a>
                  `).join('')}
                  </div>` : ''}
                </div>
          
                <h2 class="article__title">
                  <a href="${posts[i].href}">${posts[i].title}</a>
                </h2>
                    
              </div>
            </div>
          </div>
        </div>
      `;
    }
    container.insertAdjacentHTML('beforeend', newPosts);
    loadedPosts += 3;
    if (loadedPosts >= posts.length) {
      document.querySelector('.load-more-button').style.display = 'none';
    }
  }
</script>
